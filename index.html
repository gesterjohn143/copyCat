<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CopyCat - Document Printing Service</title>
    <link rel="stylesheet" href="css/style.css">
    <style>
        /* Additional styles for the map */
        #map {
            height: 500px;
            width: 100%;
            border-radius: 8px;
            margin: 20px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
    </style>
</head>
<body>
    <header>
        <div class="logo">
            dadadada
            <a href="index.html" class="logo">CopyCat</a>
        </div>
        <div class="auth-buttons">
            <button class="btn btn-login" id="loginBtn" onclick="window.location.href='login.html'">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                    <path d="M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm2-3a2 2 0 1 1-4 0 2 2 0 0 1 4 0zm4 8c0 1-1 1-1 1H3s-1 0-1-1 1-4 6-4 6 3 6 4zm-1-.004c-.001-.246-.154-.986-.832-1.664C11.516 10.68 10.289 10 8 10c-2.29 0-3.516.68-4.168 1.332-.678.678-.83 1.418-.832 1.664h10z"/>
                </svg>
                Log In
            </button>
            <button class="btn btn-primary" id="signupBtn" onclick="window.location.href='signup.html'">
                Sign Up
            </button>
        </div>
    </header>
    
    <div class="container">
        <h1>Print Your Documents Easily</h1>
        <p>Upload your document and we'll find the nearest print shop for you</p>
        
        <div class="upload-section">
            <h2>Upload Your Document</h2>
            <div id="uploadArea" class="upload-area">
                <p>Drag & drop your file here or click to browse</p>
                <label for="fileInput" class="visually-hidden">Upload Document</label>
                <input type="file" id="fileInput" accept=".pdf,.doc,.docx,.jpg,.jpeg,.png" title="Upload Document" placeholder="Choose a file to upload">
                <img id="documentPreview" class="document-preview hidden" alt="Document preview">
            </div>
            <button id="uploadBtn" class="btn">Upload Document</button>
        </div>
        
        <div id="printingOptions" class="printing-options hidden">
            <h2>Printing Options</h2>
            
            <div class="option-group">
                <h3>Paper Size</h3>
                <div class="radio-group">
                    <label class="radio-option">
                        <input type="radio" name="paperSize" value="A4" checked>
                        <span class="option-label">A4 (210 × 297 mm)</span>
                    </label>
                    <label class="radio-option">
                        <input type="radio" name="paperSize" value="Letter">
                        <span class="option-label">Letter (8.5 × 11 in)</span>
                    </label>
                    <label class="radio-option">
                        <input type="radio" name="paperSize" value="Legal">
                        <span class="option-label">Legal (8.5 × 14 in)</span>
                    </label>
                </div>
            </div>
            
            <div class="option-group">
                <h3>Print Type</h3>
                <div class="radio-group">
                    <label class="radio-option">
                        <input type="radio" name="printType" value="black-white" checked>
                        <span class="option-label">Black & White</span>
                        <span class="option-price">₱5/page</span>
                    </label>
                    <label class="radio-option">
                        <input type="radio" name="printType" value="colored">
                        <span class="option-label">Colored</span>
                        <span class="option-price">₱10/page</span>
                    </label>
                </div>
            </div>
            
            <div class="option-group">
                <h3>Additional Options</h3>
                <div class="checkbox-group">
                    <label class="checkbox-option">
                        <input type="checkbox" name="doubleSided">
                        <span class="option-label">Double-sided printing</span>
                        <span class="option-price">+₱5/page</span>
                    </label>
                    <label class="checkbox-option">
                        <input type="checkbox" name="stapled">
                        <span class="option-label">Stapled</span>
                        <span class="option-price">+₱3</span>
                    </label>
                    <label class="checkbox-option">
                        <input type="checkbox" name="holePunched">
                        <span class="option-label">Hole-punched</span>
                        <span class="option-price">+₱3</span>
                    </label>
                </div>
            </div>
            
            <div class="option-group">
                <h3>Copies</h3>
                <label for="copiesInput" class="visually-hidden">Number of Copies</label>
                <input
                    type="number"
                    id="copiesInput"
                    name="copies"
                    min="1"
                    value="1"
                    class="copies-input"
                    title="Number of copies"
                    placeholder="Enter number of copies"
                >
            </div>
            
            <button id="findShopsBtn" class="btn">Find Nearest Print Shops</button>
        </div>
        
        <div id="locationSection" class="hidden">
            <h2>Allow location access to find nearest shops</h2>
            <p>We need your location to find the closest print shops to you.</p>
            <button id="allowLocationBtn" class="btn">Allow Location Access</button>
            <p>Or enter your address manually:</p>
            <input type="text" id="manualAddress" placeholder="Enter your address">
            <button id="useManualAddressBtn" class="btn">Use This Address</button>
        </div>
        
        <div id="map"></div>
        
        <div id="shopsSection" class="hidden">
            <h2>Nearby Print Shops</h2>
            <p>Select a shop to send your print job to:</p>
            
            <div id="printShops" class="print-shops">
                <!-- Shop cards will be inserted here by JavaScript -->
            </div>
        </div>
    </div>

    <!-- Modals -->
    
        </div>
    </div>

    
        </div>
    </div>
    
    <footer>
        <p>&copy; 2023 CopyCat - Document Printing Service</p>
    </footer>

    <!-- Google Maps API -->
    <script src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&callback=initMap&libraries=places" async defer></script>

    <script>
        // Sample print shop data with Philippine locations
        const printShops = [
            {
                id: 1,
                name: "Quick Print Center",
                address: "123 Main St, Iloilo City",
                phone: "094262210654",
                hours: "Mon-Fri: 8am-6pm, Sat: 9am-3pm",
                distance: "0.5 km away",
                coordinates: { lat: 10.720
                    , lng: 122.5621 }
            },
            {
                id: 2,
                name: "Office Print Solutions",
                address: "456 Business Ave, Jaro",
                phone: "09391199262",
                hours: "Mon-Fri: 7am-7pm, Sat-Sun: 10am-2pm",
                distance: "1.2 km away",
                coordinates: { lat: 10.7325, lng: 122.5478 }
            },
            {
                id: 3,
                name: "Copy Express",
                address: "789 Commerce Rd, Mandurriao",
                phone: "09103622663",
                hours: "Mon-Sat: 9am-5pm",
                distance: "2.1 km away",
                coordinates: { lat: 10.7117, lng: 122.5453 }
            }
        ];

        // DOM elements
        const uploadArea = document.getElementById('uploadArea');
        const fileInput = document.getElementById('fileInput');
        const uploadBtn = document.getElementById('uploadBtn');
        const documentPreview = document.getElementById('documentPreview');
        const printingOptions = document.getElementById('printingOptions');
        const findShopsBtn = document.getElementById('findShopsBtn');
        const locationSection = document.getElementById('locationSection');
        const allowLocationBtn = document.getElementById('allowLocationBtn');
        const manualAddress = document.getElementById('manualAddress');
        const useManualAddressBtn = document.getElementById('useManualAddressBtn');
        const shopsSection = document.getElementById('shopsSection');
        const printShopsContainer = document.getElementById('printShops');
        const loginBtn = document.getElementById('loginBtn');
        const signupBtn = document.getElementById('signupBtn');
        const loginModal = document.getElementById('loginModal');
        const signupModal = document.getElementById('signupModal');
        const closeModals = document.querySelectorAll('.close-modal');

        // Current state
        let currentFile = null;
        let userLocation = null;
        let map = null;
        let markers = [];

        // Initialize Map
        function initMap() {
            // Default center (Iloilo City)
            const defaultCenter = { lat: 10.7202, lng: 122.5621 };
            
            map = new google.maps.Map(document.getElementById("map"), {
                zoom: 14,
                center: defaultCenter,
                mapTypeControl: false,
                streetViewControl: false,
                fullscreenControl: true,
                styles: [
                    {
                        "featureType": "poi",
                        "stylers": [{ "visibility": "off" }]
                    },
                    {
                        "featureType": "transit",
                        "stylers": [{ "visibility": "off" }]
                    }
                ]
            });
            
            // Initially hidden until needed
            document.getElementById('map').classList.add('hidden');
        }

        // Show nearby shops on map and in list
        function showNearbyShops() {
            locationSection.classList.add('hidden');
            shopsSection.classList.remove('hidden');
            document.getElementById('map').classList.remove('hidden');
            
            // Clear existing markers
            markers.forEach(marker => marker.setMap(null));
            markers = [];
            
            // Clear previous shops in list
            printShopsContainer.innerHTML = '';
            
            // Process each shop
            printShops.forEach(shop => {
                // Create marker for shop
                const marker = new google.maps.Marker({
                    position: shop.coordinates,
                    map: map,
                    icon: {
                        url: "https://maps.google.com/mapfiles/ms/icons/red-dot.png",
                        scaledSize: new google.maps.Size(32, 32)
                    },
                    title: shop.name
                });
                
                // Add info window
                const infoWindow = new google.maps.InfoWindow({
                    content: `
                        <div class="map-info-window">
                            <h3>${shop.name}</h3>
                            <p>${shop.address}</p>
                            <p>${shop.distance}</p>
                            <button onclick="selectShop(${shop.id})" class="map-select-btn">
                                Select This Shop
                            </button>
                        </div>
                    `
                });
                
                marker.addListener('click', () => {
                    infoWindow.open(map, marker);
                });
                
                markers.push(marker);
                
                // Add to shop listings
                const shopCard = document.createElement('div');
                shopCard.className = 'shop-card';
                shopCard.innerHTML = `
                    <h3>${shop.name}</h3>
                    <p>${shop.address}</p>
                    <p>${shop.phone}</p>
                    <p>${shop.hours}</p>
                    <p class="distance">${shop.distance}</p>
                    <button class="btn" onclick="selectShop(${shop.id})">Select This Shop</button>
                `;
                printShopsContainer.appendChild(shopCard);
            });
            
            // Center map on user location if available
            if (userLocation) {
                map.setCenter(userLocation);
                
                // Add user marker
                const userMarker = new google.maps.Marker({
                    position: userLocation,
                    map: map,
                    icon: {
                        path: google.maps.SymbolPath.CIRCLE,
                        scale: 8,
                        fillColor: "#4285F4",
                        fillOpacity: 1,
                        strokeWeight: 2,
                        strokeColor: "#FFFFFF"
                    },
                    title: "Your Location"
                });
                markers.push(userMarker);
            }
        }

        // Event listeners
        uploadArea.addEventListener('click', () => fileInput.click());
        uploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadArea.style.backgroundColor = '#f0f8ff';
        });
        uploadArea.addEventListener('dragleave', () => {
            uploadArea.style.backgroundColor = '';
        });
        uploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadArea.style.backgroundColor = '';
            if (e.dataTransfer.files.length) {
                handleFileSelection(e.dataTransfer.files[0]);
            }
        });

        fileInput.addEventListener('change', () => {
            if (fileInput.files.length) {
                handleFileSelection(fileInput.files[0]);
            }
        });

        uploadBtn.addEventListener('click', () => {
            if (currentFile) {
                printingOptions.classList.remove('hidden');
                uploadBtn.textContent = 'Change Document';
            } else {
                fileInput.click();
            }
        });

        findShopsBtn.addEventListener('click', () => {
            locationSection.classList.remove('hidden');
        });

        allowLocationBtn.addEventListener('click', () => {
            if (navigator.geolocation) {
                // Show loading state
                allowLocationBtn.innerHTML = '<span class="spinner"></span> Detecting Location...';
                allowLocationBtn.disabled = true;
                
                navigator.geolocation.getCurrentPosition(
                    (position) => {
                        userLocation = {
                            lat: position.coords.latitude,
                            lng: position.coords.longitude
                        };
                        showNearbyShops();
                    },
                    (error) => {
                        allowLocationBtn.innerHTML = 'Allow Location Access';
                        allowLocationBtn.disabled = false;
                        alert('Could not get your location. Please try manually entering your address.');
                    }
                );
            } else {
                alert('Geolocation is not supported by your browser. Please enter your address manually.');
            }
        });

        useManualAddressBtn.addEventListener('click', () => {
            if (manualAddress.value.trim()) {
                // In a real app, you would geocode this address to get coordinates
                // For demo, we'll use a default location (Iloilo City)
                userLocation = { lat: 10.7202, lng: 122.5621 };
                showNearbyShops();
            } else {
                alert('Please enter an address');
            }
        });

        // Modal event listeners
        loginBtn.addEventListener('click', () => {
            loginModal.classList.remove('hidden');
        });

        signupBtn.addEventListener('click', () => {
            signupModal.classList.remove('hidden');
        });

        closeModals.forEach(btn => {
            btn.addEventListener('click', () => {
                loginModal.classList.add('hidden');
                signupModal.classList.add('hidden');
            });
        });

        window.addEventListener('click', (e) => {
            if (e.target === loginModal) {
                loginModal.classList.add('hidden');
            }
            if (e.target === signupModal) {
                signupModal.classList.add('hidden');
            }
        });

        document.getElementById('loginForm').addEventListener('submit', (e) => {
            e.preventDefault();
            alert('Login functionality would be implemented here');
            loginModal.classList.add('hidden');
        });

        document.getElementById('signupForm').addEventListener('submit', (e) => {
            e.preventDefault();
            alert('Signup functionality would be implemented here');
            signupModal.classList.add('hidden');
        });

        // Functions
        function handleFileSelection(file) {
            const validTypes = ['application/pdf', 'application/msword', 
                               'application/vnd.openxmlformats-officedocument.wordprocessingml.document',
                               'image/jpeg', 'image/png'];
            
            if (!validTypes.includes(file.type) && !file.name.match(/\.(pdf|doc|docx|jpg|jpeg|png)$/i)) {
                alert('Please select a valid file type (PDF, DOC, DOCX, JPG, PNG)');
                return;
            }

            currentFile = file;
            
            // Show preview if it's an image
            if (file.type.match('image.*')) {
                const reader = new FileReader();
                reader.onload = (e) => {
                    documentPreview.src = e.target.result;
                    documentPreview.classList.remove('hidden');
                };
                reader.readAsDataURL(file);
            } else {
                documentPreview.classList.add('hidden');
            }
            
            uploadArea.innerHTML = `<p>Selected: ${file.name}</p>`;
            uploadBtn.textContent = 'Continue to Printing Options';
        }

        // Global function for shop selection
        window.selectShop = function(shopId) {
            const selectedShop = printShops.find(shop => shop.id === shopId);
            alert(`Your document has been sent to ${selectedShop.name}!\n\nYou will receive a confirmation when your print job is ready for pickup.`);
            
            console.log('Sending to print shop:', {
                shop: selectedShop,
                file: currentFile.name,
                userLocation: userLocation
            });
        };
    </script>
</body>
</html>